Parsec/Lexer«import«Lang/RegExp¸ Parsec/Input»¸ type«data«Token«s»¸ Token«s¸ String»»¸ data«Lexer«s»¸ Lexer«[«Token«s»»¸ RegExp»»»¸ define«newLexer«->«[«Token«s»»¸ Lexer«s»»¸ ->«tokens¸ do«let«matcher¸ @join«@map«tokens¸ ->>«token¸ i¸ do«let«Token«_¸ re»¸ token»¸ _concat«[«"(?<g"¸ _show«i»¸ ">"¸ re¸ ")"»»»»»¸ "|"»»¸ Lexer«tokens¸ _reflags«matcher¸ "yu"»»»»»¸ matchToken«->«Lexer«s»¸ String¸ Number¸ ?«Token«s»»»¸ ->«Lexer«tokens¸ matcher»¸ input¸ pos¸ do«RegExp:«.lastIndex.set«matcher¸ pos»»¸ match«RegExp:«.exec«matcher¸ input»»¸ |«?«m»¸ @first«tokens¸ ->>«token¸ i¸ match«:get«RegExpExecArray:«.groups«m»»¸ ##«"g"¸ _show«i»»»¸ |«?«s»¸ do«let«Token«t¸ _»¸ token»¸ ?«Token«t¸ s»»»»¸ |«_¸ Null»»»»»¸ |«_¸ Null»»»»»»»